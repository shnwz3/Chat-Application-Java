import javax.swing.*;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

public class ChatApplication {
    private JFrame mainFrame;
    private JFrame youChatWindow;
    private JFrame friendChatWindow;

    public ChatApplication() {
        mainFrame = new JFrame("Chat Application");
        mainFrame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        mainFrame.setSize(400, 600);
        mainFrame.setLayout(new BorderLayout());
        

        // Create a button to start the chat
        JButton startChatButton = new JButton("Start Chat");
        startChatButton.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                createChatWindows();
            }
        });
        mainFrame.add(startChatButton, BorderLayout.CENTER);

        mainFrame.setVisible(true);
    }

    private void createChatWindows() {
        mainFrame.setVisible(false);

        youChatWindow = createChatWindow("You");
        friendChatWindow = createChatWindow("Friend");

        // Add a listener to close all windows when any chat window is closed
        youChatWindow.setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
        friendChatWindow.setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
        youChatWindow.addWindowListener(new java.awt.event.WindowAdapter() {
            @Override
            public void windowClosing(java.awt.event.WindowEvent windowEvent) {
                closeAllWindows();
            }
        });

        friendChatWindow.addWindowListener(new java.awt.event.WindowAdapter() {
            @Override
            public void windowClosing(java.awt.event.WindowEvent windowEvent) {
                closeAllWindows();
            }
        });
    }

    private JFrame createChatWindow(String title) {
        JFrame chatWindow = new JFrame(title);
        chatWindow.setSize(400, 500);
        chatWindow.setLayout(new BorderLayout());

        JTextArea chatTextArea = new JTextArea();
        chatTextArea.setEditable(false);
        JScrollPane chatScrollPane = new JScrollPane(chatTextArea);
        chatWindow.add(chatScrollPane, BorderLayout.CENTER);

        JTextField messageField = new JTextField();
        JButton sendButton = new JButton("Send");
        JPanel inputPanel = new JPanel(new BorderLayout());
        inputPanel.add(messageField, BorderLayout.CENTER);
        inputPanel.add(sendButton, BorderLayout.EAST);
        chatWindow.add(inputPanel, BorderLayout.SOUTH);

        sendButton.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                String message = messageField.getText();
                if (!message.isEmpty()) {
                    chatTextArea.append(title + ": " + message + "\n");
                    messageField.setText("");
                }
            }
        });

        chatWindow.setVisible(true);
        return chatWindow;
    }

    private void closeAllWindows() {
        if (youChatWindow != null) {
            youChatWindow.dispose();
        }
        if (friendChatWindow != null) {
            friendChatWindow.dispose();
        }
        mainFrame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                new ChatApplication();
            }
        });
    }
}
